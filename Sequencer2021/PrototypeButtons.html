<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">

  <title>OOMPH Sequencer</title>
  <meta name="description" content="The HTML5 Herald">
  <meta name="author" content="SitePoint">

<!-- CSS only -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BmbxuPwQa2lc/FVzBcNJ7UAyJxM6wuqIj61tLrc4wSX0szH/Ev+nYRRuWlolflfl" crossorigin="anonymous">
<!-- JavaScript Bundle with Popper -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/js/bootstrap.bundle.min.js" integrity="sha384-b5kHyXgcpbZJO/tY9Ul7kGkf1S0CWuKcCD38l8YkeH8z8QjE0GmW1gYU5S9FOnJ0" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

</head>

<body>
  <img src="images/OOMPHHeader.png">
  <hr>
    <div class="container">
        
    <!-- Content here -->
    <div class="row">
      <div class="col-sm-4">
        <div id="hide">
        <label  for="startingTerm">Choose starting term:</label>
          <select name="startingTerm" id="startingTerm">
            <!-- <option value=0>Fall 1 (15 week course)</option> -->
            <option value=1>Fall 1</option>
            <!-- <option value=2>Fall 2</option> -->
            <!-- <option value=3>Spring 1 (15 week course)</option> -->
            <option value=4>Spring 1</option>
            <!-- <option value=5>Spring 2</option> -->
            <!-- <option value=6>Summer 1 (15 week course)</option> -->
            <option value=7>Summer 1</option>
            <!-- <option value=8>Summer 2</option> -->

          </select>
          <br><br>
          <label for="startingYear">Choose starting year:</label>
          <select name="startingYear" id="startingYear">
            <option value=0>Choose a year</option>
          </select>
          <br><br>
          <button class= "btn btn-success" id="btn0">Update Start Term/Year</button><hr/>

        </div>

          <br><br> 
         <h6 id="CTCY"> One of three columns</h6>
         <p id ="CurCourse"></p><hr/>
         <button class= "btn btn-success" id="btn1">Add to sequence</button><hr/>
          <button class= "btn sample btn-info" id="1">Load HPM Sequence</button><hr/>
          <button class= "btn sample btn-info" id="2">Load Interdisciplinary Sequence</button><hr/>
          <button class= "btn sample btn-info" id="3">Load Epi/Bio Sequence</button><hr/>

          <div id="UnitsLeft">Credits left: 42; Total credits: 0</div><hr/>
          <div id="FinalTerm"></div><hr/>
          <p id="Sequence">Sequence:</p>
          

      </div>
      <div class="col-sm-4">
          <h6>Core and Breadth Courses</h6>
        <div id="CandB"></div>
      </div>
      <div class="col-sm-4">
         <h6>Programatic Courses</h6>
        <div id="ProgC"></div>
      </div>
    </div>
  <!-- <div id="CandB"></div> -->
</div>
  <script>
  let ct=0; //current term (including extra 15 week terms);
  let cy =0; //cur year
  let ctd=0; //current term dates
  let cta=1;//currentTermActual
  var terms = ["Fall 15","Fall 1","Fall 2","Spring 15","Spring 1","Spring 2","Summer 15","Summer 1","Summer 2"];
  var termsActual = ["Fall 1","Fall 2","Spring 1","Spring 2","Summer 1","Summer 2"];
  var termsDates =  ["Dates: 08/23 to 12/19","Dates: 08/23 to 10/17","Dates: 10/25 to 12/19","Dates: 1/11 to 05/01","Dates: 01/11 to 03/06","Dates: 03/07 to 05/01","Dates: 05/09 to 08/14","Dates: 05/09 to 06/26","Dates: 06/27 to 08/14","TBA"];
  var termsVacayDates =  ["Break: 12/20 to 1/10","Break: 12/20 to 1/10","Break: 12/20 to 1/10","Break: 5/2 to 5/8","Break: 5/2 to 5/8","Break: 5/2 to 5/8","Break: 08/15 to TBA","Break: 08/15 to TBA","Break: 08/15 to TBA",""];
  var years =[2021]
  var seqs=[];

  var finalTerm =2;
  var finalYear=2;
  var d = new Date();
  var n = d.getFullYear();
  var m = d.getMonth();

  var unitsLeft=14;
  var creditsLeft=42;

  let courses =[];
  let sample1=[1,6,7,0,13,8,29,22];

  let hpmFall=[1,6,11,16,20,18,2,9,13,25,21,41,9,42];
  let hpmSpring=[11,16,20,18,1,6,13,25,21,41,9,42,44,45];
  let hpmSummer=[20,18,1,6,11,16, 21,41,2,9,13,25,22,47];

  let epiFall=[1,6,11,16,20,47,5,4,27,33,45,21,47,40,41,42];
  let epiSpring=[11,16,20,47,1,6,33,45,21,47,5,4,27,33,45];
  let epiSummer=[20,47,1,6,11,16,21,47,41,27,33,45,22,47];

  let interFall=[1,6,0,11,16,0,20,47,0,40,41,42,43,44,45,21,47,40,41,41];
  let interSpring=[11,16,20,47,1,6,43,44,45,21,47,40,41,42,43,44,45];
  let interSummer=[20,47,1,6,11,16,21,47,40,41,42,43,44,45,22,47];

  let hpm=[];
  let intD=[];
  let curCourse=0;
  var CTCY = $("#CTCY");
  var br="<br/>";
  var CandB= $("#CandB");
  var ProgC= $("#ProgC");
  var editingSequence=false;
  var editIndex=0;
  var editTerm=0;
  var editYear=0;
  
  var creditsTotal=0;
  var select = document.getElementById("startingYear");

$(document).ready(function(){
      for(var i=years[0]+1;i<years[0]+100;i++)
      {
          years.push(i);
      }

      //populate years dropdown
      for(var i = 0; i < years.length-10; i++) {
        var opt = years[i];
        var el = document.createElement("option");
        el.textContent = opt;
        el.value = i;
        select.appendChild(el);
        }
        //finalTerm=2;
        //finalYear=2;
        $("#FinalTerm").text(`Estimated Final Term: ${termsActual[finalTerm]}, ${years[finalYear]}`)
        //FinalTerm();
      CTCY.text(terms[ct]+" "+years[cy]+"; "+termsDates[ctd]+" "+termsVacayDates[ctd])
      //console.log(years);
      $(document).on("click","#btn1",function(){

          AddToSequence(curCourse);
      });
      $(document).on("click","#btn0",function(){
        SetStartingTerm();
            });
      $(document).on("click",".btn-course",function(){
         curCourse=this.id;
         $("#btn1").show();
          $("#CurCourse").show();
          CTCY.show();
          $("#FinalTerm").show();
          $("h6").show();
          SetCourses(ct);
      });
      $(document).on("click",".btn-sequence",function(){
          $("#btn1").show();
          $("h6").show();
          $("#CurCourse").show();
          CTCY.show();
          $("#FinalTerm").show();
          //console.log(this.id);
          ChangeSequence(this.id);
          
      });
      $(document).on("click",".sample",function(){
          // console.log(this.id)
          if(this.id==1){
              console.log(ct);
            if(ct===0||ct===1){
              SetSampleSequence(hpmFall);
            }
            if(ct===4){
              SetSampleSequence(hpmSpring);
            }
            if(ct===7){
              SetSampleSequence(hpmSummer);
            }
          }//SetSampleSequence(sample1);
          if(this.id==2){
            if(ct===0||ct===1){
              SetSampleSequence(interFall);
            }
            if(ct===4){
              SetSampleSequence(interSpring);
            }
            if(ct===7){
              SetSampleSequence(interSummer);
            }
          }
          if(this.id==3){
            if(ct===0||ct===1){
              SetSampleSequence(epiFall );
            }
            if(ct===4){
              SetSampleSequence(epiSpring );
            }
            if(ct===7){
              SetSampleSequence(epiSummer );
            }
          }

      });
      
      //FinalTerm();
  });
function FinalTerm()
  {
    
}
function CourseListing(arr) {
      courses=arr;
      // console.log(courses)
      SetCourses(ct);
      
      
  }
  function SampleOne(arr)
  {
      //sample1=arr;
      // console.log(sample1);
  }
  function HealthPolicyManagement(arr)
  {
      hpm=arr;
      //console.log(hpm);
  }
  function Interdisciplinary(arr)
  {
      intD=arr;
      //console.log(intD);
  }
  function SetCourses(xX){
      CandB.empty();
      ProgC.empty();
      //console.log(xX);
      if(creditsLeft>0)//     if(unitsLeft>0)

      {
          for(i = 0; i<courses.length; i++) {
          if((courses[i].term===xX ||courses[i].term===-1 ) && courses[i].inSequence===false){ 
              if(courses[i].column===0) 
              {
                  CandB.append(`<div class="cardz" >
                      <div class="cardz-body">
                      <p class="cardz-header">${i} ID: ${courses[i].id}: ${courses[i].name}: ${courses[i].title}${br}Credits:${courses[i].credits}; Weeks: ${courses[i].weeks} </p>
                      <p class="btn btn-primary btn-course" id = "${courses[i].id}">Select</p>
                      </div>
                      </div>`)
              }
                  // CandB.append(`<p id="${courses[i].id}">${i} ID: ${courses[i].id}: ${courses[i].name}: ${courses[i].title}${br}</p>`)
              else {
                  ProgC.append
                      (`<div class="cardz">
                          <p class="cardz-header">${i} ID: ${courses[i].id}: ${courses[i].name}: ${courses[i].title}${br}Credits:${courses[i].credits}; Weeks: ${courses[i].weeks} </p>
                          <div class="cardz-body">
                          <p class="btn btn-primary btn-course" id = "${courses[i].id}">Select</p>
                          </div>
                      </div>`)}
          }
      }
  }
      $("#CurCourse").text(`${courses[curCourse].name}: ${courses[curCourse].title}`)

  }
  function SetSampleSequence(sample)
  {
     for (let iI=0;iI<sample.length;iI++) 
     {
      AddToSequence(sample[iI]);
     }
  }
  function AddToSequence(xX)
  {
      $(".sample").hide();
      $("#hide").hide();
      if(courses[xX].id>0){
          unitsLeft--;
          creditsLeft-=courses[xX].credits;
          creditsTotal+=courses[xX].credits;
          courses[xX].inSequence=true;
      }
      else {
          courses[xX].inSequence=false;
          if(!editingSequence &&  (ct!=0 && ct!=3 && ct!=6)){
              finalTerm++;
              if(finalTerm>5)finalTerm=0;
              if(finalTerm===2)finalYear++;
      }
          $("#FinalTerm").text(`Estimated Final Term: ${termsActual[finalTerm]}, ${years[finalYear]}`)

      }
      //$("#UnitsLeft").text(`Credits left: ${creditsLeft}; Total Credits:${creditsTotal}`)
      if(creditsLeft<=0){//if(unitsLeft<=0){
          $("#btn1").hide();
          $("#hide").hide();
          $("#CurCourse").hide();
          CTCY.hide();
          $("#FinalTerm").hide();
          CandB.empty();
          ProgC.empty();
          $("h6").hide();
      }
      
      if(!editingSequence){
          var seq = new SequenceThis(ct,cy,courses[xX])
          seqs.push(seq);
         
          ChangeTerm();
      }
      else {
          var seq = new SequenceThis(editTerm,editYear,courses[xX])
          seqs[editIndex]=seq;
          editIndex=0;
          editTerm=0;
          editYear=0;
          editingSequence=false;
          curCourse=0;
          CTCY.empty();
          CTCY.text(terms[ct]+" "+years[cy]+"; "+termsDates[ctd]+"; "+termsVacayDates[ctd]);
          SetCourses(ct);
          //ct--;
      }
      // seqs.push(courses[xX])
      //console.log(seqs);
      
      RenderSequence();
  }
  function ChangeTerm(){
  curCourse=0;
      ct++;
      ctd++;
      
      if(ct>8)ct=0;
      
      GetActualTerm();
      
      //console.log("CTA: "+termsActual[cta])
      if(ctd>9)ctd=9;
      if(ct===3)cy++;
      CTCY.empty();
      
      CTCY.text(terms[ct]+" "+years[cy]+"; "+termsDates[ctd]+"; "+termsVacayDates[ctd]);
      SetCourses(ct);
 

  }
  function SetStartingTerm(){
    var e = document.getElementById("startingTerm");
    var f = document.getElementById("startingYear");
    curCourse=0;
    ct=parseInt(e.options[e.selectedIndex].value);
    cy=parseInt(f.options[f.selectedIndex].value);
    ctd=ct;
    if(ct>8)ct=0;
    GetActualTerm();
    if(cy>1)ctd=9;
    //FinalTerm();  //if(ct===3)cy++;
    CTCY.empty();
      //console.log(ct+0);
      CTCY.text(terms[ct]+" "+years[cy]+"; "+termsDates[ctd]+"; "+termsVacayDates[ctd]);
      SetCourses(ct);
      finalTerm=cta+2;
      if(finalTerm==6)
      {
        finalTerm=0;
      }
      if(finalTerm==7)
      {
        finalTerm=1;
      }
        finalYear=cy+2;
        if(finalYear>years.length)
        {finalYear=0}
        $("#FinalTerm").text(`Estimated Final Term: ${termsActual[finalTerm]}, ${years[finalYear]}`)
      //FinalTerm();
  }
  function SequenceThis (term, year, course)
  {
  
  this.term=term;
  this.year=year;
  this.course=course;
  this.termActual=GetActualTerm();
  
  }
  function GetCreditsLeft(){
    return creditsLeft;
  }
  function GetCreditsTotal(){
    return creditsTotal;
  }
  function GetActualTerm(){
    switch(ct){
          case 0:
          cta=0;
          break;
        
          case 1:
          cta=0;
          break;
        
          case 2:
          cta=1;
          break;
         
          case 3:
          cta=2;
          break;

          case 4:
          cta=2;
          break;
        
          case 5:
          cta=3;
          break;

          case 6:
          cta=4;
          break;
          
          case 7:
          cta=4;
          break;
          
          case 8:
          cta=5;
          break;
          default:
    }
    return cta;
  }
  function RenderSequence()
  {
    $("#Sequence").empty()
    var totalZ=seqs.length;
    //if(totalZ>14)totalZ=14;
    for(i = 0; i<totalZ; i++) {
      if(seqs[i].course.name != "Choose From") { 
          $("#Sequence").append(`<p><a class="btn-sequence" id = "${i}">[Change] </a>${seqs[i].course.id} ${terms[seqs[i].term]}, ${years[seqs[i].year]}  - ${seqs[i].course.name}: ${seqs[i].course.title}</p>
        
        `)
    }
    else {
        $("#Sequence").append(`<p>${terms[seqs[i].id]} ${terms[seqs[i].term]}, ${years[seqs[i].year]}  - ${seqs[i].course.name}: ${seqs[i].course.title}</p>
        <p class="btn btn-warning btn-sequence" id = "${i}">Choose Course</p>
  `)
    }

    }
    $("#UnitsLeft").text(`Credits left: ${GetCreditsLeft()}; Total Credits:${GetCreditsTotal()}`)
}
  function ChangeSequence(xX)
  {
    //console.log(seqs[xX]);
    var seq = new SequenceThis(seqs[xX].term,seqs[xX].year,courses[0]);
    editingSequence=true;
    editIndex=xX;
    editTerm=seqs[xX].term;
    editYear=seqs[xX].year;
    // console.log(seqs[xX].course.id);
    if(courses[seqs[xX].course.id].id>0){
            unitsLeft++;
            //console.log(seqs[xX].course.credits);
            creditsLeft+=courses[seqs[xX].course.id].credits;
            creditsTotal-=courses[seqs[xX].course.id].credits;
            courses[seqs[xX].course.id].inSequence=false;
            finalTerm++;
            if(finalTerm>5)finalTerm=0;
            if(finalTerm===2)finalYear++;
            $("#FinalTerm").text(`Estimated Final Term: ${termsActual[finalTerm]}, ${years[finalYear]}`)
            //$("#UnitsLeft").text(`Credits left: ${creditsLeft}; Total Credits:${creditsTotal}`)
        }
        //console.log(courses)
        CTCY.text(terms[editTerm]+" "+years[editYear])
        seqs[xX]=seq;
        // $("#UnitsLeft").text(`Credits left: ${creditsLeft}; Total Credits:${creditsTotal}`)
    SetCourses(seqs[xX].term);
    RenderSequence();

}
  </script>
  
  <script src="./js/courses.js"></script>
  <script src="./js/Interdisciplinary.js"></script>
  <script src="./js/HealthPolicyManagement.js"></script>

  <!-- <script src="./js/sample1.js"></script> -->


  <script src="https://code.jquery.com/jquery-3.5.1.js" integrity="sha256-QWo7LDvxbWT2tbbQ97B53yJnYU3WhH/C8ycbRAkjPDc=" crossorigin="anonymous"></script>
<!-- <script type="text/javascript" src="./js/login.js"></script> -->
      </div>
      <img src="images/OOMPHFooter.png">    
</body>
</html>


